# Vibe-Study 用户模块 - 测试指南

## 🎯 测试场景

### 场景1: 用户注册

**URL**: http://localhost:3000/auth/register

**步骤**:
1. 填写用户名（3-20位字母数字下划线）
2. 填写昵称（2-20位）
3. 填写邮箱（正确格式）
4. 点击"获取验证码"
   - ✅ 按钮变为倒计时（60秒）
   - ✅ 查看后端控制台，应看到验证码（开发环境）
5. 输入验证码
6. 输入密码（6-20位，必须包含字母和数字）
7. 再次输入密码
8. 点击"注册"

**预期结果**:
- ✅ 显示"注册成功"消息
- ✅ 自动登录并跳转到首页
- ✅ 顶部导航显示用户头像和昵称

**错误测试**:
- 用户名已存在 → 提示"用户名已存在"
- 验证码错误 → 提示"验证码错误或已过期"
- 密码格式不符 → 前端表单验证拦截
- 两次密码不一致 → 前端表单验证拦截

---

### 场景2: 用户登录

**URL**: http://localhost:3000/auth/login

**测试账号**:
```
账号: test_user_1 或 test1@example.com
密码: Test1234
```

**步骤**:
1. 输入用户名或邮箱
2. 输入密码
3. 勾选"记住我"（可选）
4. 点击"登录"

**预期结果**:
- ✅ 显示"登录成功"
- ✅ 跳转到首页
- ✅ Token保存到localStorage
- ✅ 顶部导航显示用户信息

**错误测试**:
- 用户不存在 → "用户名或密码错误"
- 密码错误 → "用户名或密码错误"
- 账号已禁用 → "账号已被禁用"

---

### 场景3: 查看个人主页

**URL**: http://localhost:3000/user/profile

**步骤**:
1. 登录后点击顶部头像
2. 选择"个人主页"

**预期结果**:
- ✅ 显示用户头像（或昵称首字母）
- ✅ 显示昵称和用户名
- ✅ 显示关注数和粉丝数
- ✅ 显示个人简介（如果有）
- ✅ 显示性别、生日、邮箱、手机号（如果有）
- ✅ 右上角显示"编辑资料"按钮

---

### 场景4: 查看他人主页

**URL**: http://localhost:3000/user/profile/2

**步骤**:
1. 登录后直接访问URL（用户ID=2）

**预期结果**:
- ✅ 显示该用户的所有公开信息
- ✅ 右上角显示"关注"或"已关注"按钮
- ✅ 点击"关注"后：
  - 按钮变为"已关注"
  - 该用户的粉丝数+1
  - 当前用户的关注数+1（可在自己主页查看）
- ✅ 点击"已关注"可取消关注（数据相应减1）

**错误测试**:
- 访问不存在的用户ID → 提示"获取用户信息失败"
- 尝试关注自己（通过API） → 后端拦截"不能关注自己"

---

### 场景5: 编辑个人资料

**URL**: http://localhost:3000/user/settings

**步骤**:
1. 从个人主页点击"编辑资料"
2. 或从顶部菜单进入"设置"
3. 在"个人资料" Tab：
   - 修改昵称
   - 修改个人简介
   - 选择性别
   - 选择生日
4. 点击"保存修改"

**预期结果**:
- ✅ 显示"保存成功"
- ✅ 页面数据自动刷新
- ✅ 返回个人主页可看到更新后的信息
- ✅ 顶部导航昵称实时更新

**表单验证**:
- 昵称为空 → "请输入昵称"
- 昵称过长（>20字符） → "昵称长度为 2-20 个字符"
- 简介过长（>200字符） → "个人简介不能超过 200 个字符"
- 生日选择未来日期 → 日期选择器禁用

---

### 场景6: 修改密码

**URL**: http://localhost:3000/user/settings （切换到"修改密码" Tab）

**步骤**:
1. 输入当前密码
2. 输入新密码（6-20位，必须包含字母和数字）
3. 再次输入新密码
4. 点击"修改密码"

**预期结果**:
- ✅ 显示"密码修改成功，请重新登录"
- ✅ 表单自动重置
- ✅ （可选）自动退出登录并跳转到登录页

**错误测试**:
- 当前密码错误 → "当前密码错误"
- 新密码与旧密码相同 → "新密码不能与旧密码相同"
- 两次新密码不一致 → "两次输入的密码不一致"
- 新密码不符合格式 → 前端验证拦截

---

## 📊 测试检查清单

### 功能测试

- [ ] 用户注册（成功）
- [ ] 用户注册（用户名重复）
- [ ] 用户注册（验证码错误）
- [ ] 邮箱验证码发送
- [ ] 邮箱验证码倒计时
- [ ] 用户登录（成功）
- [ ] 用户登录（密码错误）
- [ ] 用户登录（用户不存在）
- [ ] Token持久化（刷新页面仍保持登录）
- [ ] 查看自己的主页
- [ ] 查看他人的主页
- [ ] 关注用户（成功）
- [ ] 取消关注（成功）
- [ ] 关注数和粉丝数正确显示
- [ ] 编辑个人资料（成功）
- [ ] 昵称实时更新到导航栏
- [ ] 修改密码（成功）
- [ ] 修改密码（旧密码错误）
- [ ] 修改密码（新旧密码相同）
- [ ] 退出登录